<!DOCTYPE html>
<!-- Version: 2.5.7 | Date: 2025-05-07 | ERP_2.5.7_2025-05-07 -->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DHS Class of 1975 - 50-Year Reunion Registration (Option 2)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f5f5f5; padding: 20px; }
    .form-container { background: #f0f0f0; padding: 20px; max-width: 700px; margin: auto; border-radius: 8px; }
    h1, h2, h3 { text-align: center; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input[type="text"], input[type="number"], textarea, select {
      width: 100%; padding: 8px; margin-top: 5px; background-color: #ffffff;
      border: 1px solid #ccc; border-radius: 4px;
    }
    input.invalid { background-color: #fff8dc; border: 2px solid #ffcc00; }
    #emailError { color: #cc9900; font-size: 0.9em; margin-top: 5px; display: none; }
    #emailWarning {
      margin-top: 20px; font-size: 0.95em; background-color: #fff3cd;
      color: #856404; padding: 15px; border-radius: 6px; display: none;
    }
    #standby-message { display: none; font-weight: bold; color: #333; margin-top: 20px; text-align: center; }
    select { width: 80px; }
    .events-table { width: 100%; margin-top: 20px; border-collapse: collapse; }
    .events-table th, .events-table td { padding: 10px; text-align: center; }
    .events-table th { background-color: #e0e0e0; }
    .events-table td { background-color: #ffffff; }
    .submit-btn {
      margin-top: 30px; width: 100%; padding: 12px; font-size: 16px;
      background: black; color: white; border: none; border-radius: 6px; cursor: pointer;
    }
    .summary-box, .mail-section, .thank-you {
      background: #e8f0fe; padding: 15px; margin-top: 30px; border-radius: 6px; text-align: center; font-size: 1rem;
    }
    .thank-you { display: none; background-color: #dff0d8; color: #3c763d; padding: 25px; }
  </style>
</head>
<body>
<div class="form-container">
  <input type="hidden" id="currentReunionFee" value="45">
  <h1>DHS Class of 1975</h1>
  <h2>50-Year Reunion Registration</h2>
  <h3>Registration Option #2: Register Online, Pay by Check</h3>
  <form id="reunionForm" onsubmit="submitForm(event)">
    <input type="hidden" name="RegistrationFee" value="">
    <input type="hidden" name="TotalDue" id="hiddenTotalDue" value="">

    <label>Classmate Name:</label><input type="text" name="classmate_name" required />
    <label>1975 First and Last Name (if different):</label><input type="text" name="name_1975" />
    <label>Spouse/Guest Name (if attending):</label><input type="text" name="guest_name" />
    <label>Mailing Address:</label><input type="text" name="mailing_address" />
    <label>Email Address:</label><input type="text" name="email" id="email" placeholder="example@gmail.com" />
    <div id="emailError">Please recheck your email — something doesn’t look quite right.</div>
    <label>Phone:</label><input type="text" name="phone" />
    <label>Preferred classmate name for Nametag:</label><input type="text" name="classmate_nametag" />
    <label>Preferred spouse/guest name for Nametag:</label><input type="text" name="guest_nametag" />
    <label>Notes:</label><textarea name="notes" rows="3"></textarea>

    <table class="events-table">
      <thead><tr><th>Event</th><th>Classmate</th><th>Guest</th></tr></thead>
      <tbody>
        <tr><td>Friday Tour</td><td><select name="friday_tour_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="friday_tour_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Tailgate Party</td><td><select name="tailgate_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="tailgate_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Football Game</td><td><select name="football_game_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="football_game_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Saturday Tour</td><td><select name="saturday_tour_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="saturday_tour_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Saturday Breakfast</td><td><select name="saturday_breakfast_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="saturday_breakfast_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Saturday Golf</td><td><select name="saturday_golf_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="saturday_golf_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
        <tr><td>Reunion Dinner</td><td><select name="reunion_dinner_classmate"><option></option><option>Y</option><option>N</option></select></td>
        <td><select name="reunion_dinner_guest"><option></option><option>Y</option><option>N</option></select></td></tr>
      </tbody>
    </table>

    <label>Legacy Fund Contribution (optional):</label>
    <input type="number" name="legacy_fund" min="0" placeholder="$0.00" />

    <div class="summary-box">
      <h4>Registration Summary</h4>
      <p><strong>Attendees:</strong> <span id="summary-attendees"></span></p>
      <p><strong>Reunion Fee:</strong> <span id="summary-cost"></span></p>
      <p><strong>Legacy Fund Contribution:</strong> <span id="summary-legacy"></span></p>
      <p><strong>Total Amount Due:</strong> <span id="summary-total"></span></p>
    </div>

    <div class="mail-section">
      <p><strong>Mail your check to:</strong><br>Nancy Broadstone<br>Dyer County Trustee<br>P.O. Box 1360<br>Dyersburg, TN 38025-1360</p>
    </div>

    <button type="submit" class="submit-btn" id="submit-button">Submit Registration</button>
  </form>

  <p id="standby-message">Please stand by while we process your registration...</p>

  <div id="thankYouMessage" class="thank-you">
    <h2>Thank You for Registering!</h2>
    <p>Your form was submitted successfully.</p>
  </div>
</div>

<script>
function isValidEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function updateSummary() {
  const guestName = document.querySelector('[name="guest_name"]').value.trim();
  const legacyFund = parseFloat(document.querySelector('[name="legacy_fund"]').value) || 0;
  const feePerPerson = parseFloat(document.querySelector('[name="RegistrationFee"]').value) || 45;
  const attendees = guestName ? 2 : 1;
  const reunionFee = attendees * feePerPerson;
  const totalDue = reunionFee + legacyFund;

  document.getElementById('summary-attendees').innerText = attendees;
  document.getElementById('summary-cost').innerText = `$${reunionFee.toFixed(2)}`;
  document.getElementById('summary-legacy').innerText = `$${legacyFund.toFixed(2)}`;
  document.getElementById('summary-total').innerText = `$${totalDue.toFixed(2)}`;
  document.getElementById('hiddenTotalDue').value = totalDue.toFixed(2);
}

document.addEventListener("DOMContentLoaded", () => {
  updateSummary();
  document.querySelector('[name="guest_name"]').addEventListener('input', updateSummary);
  document.querySelector('[name="legacy_fund"]').addEventListener('input', updateSummary);
});

function submitForm(event) {
  event.preventDefault();
  updateSummary();

  const form = document.getElementById("reunionForm");
  const formData = new FormData(form);

  fetch("https://script.google.com/macros/s/AKfycbxUcYEi4zCIxEcqCd-aG5mrk4hZ7TqIL5kWFHnnd0OvohfYDCZZykczxOESKyOu8g4ydA/exec", {
    method: "POST",
    body: formData,
    mode: "cors"
  })
  .then(() => {
    let params = new URLSearchParams();
    formData.forEach((value, key) => {
      params.append(key, value);
    });
    window.location.href = "thank-you.html?" + params.toString();
  })
  .catch((error) => {
    alert("Something went wrong. Please try again later.");
    console.error("Submission error:", error);
  });
}
</script>
</body>
</html>



























